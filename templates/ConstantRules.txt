1. Add only features that enhance the function of the snippet.
2. Keep explanations brief, focusing on code changes.
3. Ensure revised code can directly replace the current block.
4. Verify functionality with default settings.
5. Retain original class names for enhanced classes.
6. Format enhanced code in Markdown.
7. Exclude initial setup or demonstration code.
8. Maintain original tensor input and output sizes.
9. Provide complete code, including all parts.

Take a deep breath and let us think step by step!